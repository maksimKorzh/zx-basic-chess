05 CLS
10 PRINT AT 0, 9; "ZX BASIC CHESS"
20 PRINT AT 2, 15; "by"
30 PRINT AT 4, 8; "Code Monkey King"
40 DATA 13, 13, 13, 13, 13, 13, 13, 13, 13, 13
41 DATA 13, 13, 13, 13, 13, 13, 13, 13, 13, 13
42 DATA 13, 10,  8,  9, 11, 12,  9,  8, 10, 13
43 DATA 13,  7,  7,  7,  7,  7,  7,  7,  7, 13
44 DATA 13,  0,  0,  0,  0,  0,  0,  0,  0, 13
45 DATA 13,  0,  0,  0,  0,  0,  0,  0,  0, 13
46 DATA 13,  0,  0,  0,  0,  0,  0,  0,  0, 13
47 DATA 13,  0,  0,  0,  0,  0,  0,  0,  0, 13
48 DATA 13,  0,  1,  1,  1,  1,  1,  1,  1, 13
49 DATA 13,  4,  2,  3,  5,  6,  3,  2,  4, 13
50 DATA 13, 13, 13, 13, 13, 13, 13, 13, 13, 13
51 DATA 13, 13, 13, 13, 13, 13, 13, 13, 13, 13
55 DIM BOARD(120)
56 LET SIDE=0
60 FOR I=0 TO 119
90 READ BOARD(I)
100 NEXT I
110 DATA 46, 80, 78, 66, 82, 81, 75, 112, 110, 98, 114, 113, 107, 32 REM 32 - ' '; 88 - 'X'
120 DIM PIECES(14)
130 FOR I=0 TO 13
140 READ PIECES(I)
150 NEXT I

155 GOTO 220

160 FOR ROW=0 TO 11
170 FOR COL=0 TO 9
180 PRINT AT ROW+6, COL+11; CHR(PIECES(BOARD(ROW*10+COL)))
190 NEXT COL
200 NEXT ROW
210 RETURN

220 DATA 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1
230 DIM TYPES(12)
240 FOR I=0 TO 12
250 READ TYPES(I)
260 NEXT I

270 DIM PST(120)
280 FOR ROW=0 TO 11
290 FOR COL=0 TO 9
300 IF BOARD(ROW*10+COL) = 13 PST(ROW*10+COL) = 0 ELSE PST(ROW*10+COL) = (16-(ROW-6)*(ROW-6))+ (16-(COL-5)*(COL-5))
310 NEXT COL
320 NEXT ROW

330 DATA 0, 100, 300, 350, 500, 900, 0, -100, -300, -350, -500, -900, 0
340 DIM WEIGHTS(12)
350 FOR I=0 TO 12
360 READ WEIGHTS(I)
370 NEXT I

379 DATA   0,   0,   0,   0,   0,   0,   0,   0
380 DATA -10, -20,  -9, -11,   0,   0,   0,   0
381 DATA -19, -21,  21,  19,  -8, -12,  12,   8
382 DATA  -9, -11,  11,   9,   0,   0,   0,   0
383 DATA -10,   1,  10,  -1,   0,   0,   0,   0
384 DATA -10,   1,  10,  -1,  -9, -11,  11,   9
385 DATA -10,   1,  10,  -1,  -9, -11,  11,   9
386 DATA  10,  20,   9,  11,   0,   0,   0,   0
387 DATA -19, -21,  21,  19,  -8, -12,  12,   8
388 DATA  -9, -11,  11,   9,   0,   0,   0,   0
389 DATA -10,   1,  10,  -1,   0,   0,   0,   0
390 DATA -10,   1,  10,  -1,  -9, -11,  11,   9
391 DATA -10,   1,  10,  -1,  -9, -11,  11,   9
400 DIM DIRECTIONS(13, 8)
410 FOR P=0 TO 12
420 FOR I=0 TO 7
430 READ DIRECTIONS(P, I)
440 NEXT I
450 NEXT P

500 FOR SQUARE=21 TO 98
510 IF BOARD(SQUARE)=13 OR BOARD(SQUARE)=0 THEN CONTINUE FOR
520 PIECE = BOARD(SQUARE)
530 IF ((PIECES(PIECE)&32)=32)=SIDE THEN GOTO 540 ELSE CONTINUE FOR 
540 FOR DIRECTION=0 TO 7
550 IF DIRECTIONS(PIECE, DIRECTION)=0 THEN CONTINUE FOR
560 LET TARGET_SQUARE = SQUARE
570 DO
580 TARGET_SQUARE = TARGET_SQUARE + DIRECTIONS(PIECE, DIRECTION)
590 CAPTURED_PIECE = BOARD(TARGET_SQUARE)
600 IF CAPTURED_PIECE=13 THEN CONTINUE FOR
610 IF CAPTURED_PIECE <> 0 AND ((PIECES(CAPTURED_PIECE)&32)=32)=SIDE THEN CONTINUE FOR
650 BOARD(SQUARE)=0
660 BOARD(TARGET_SQUARE)=PIECE
670 REM
680 REM
690 REM
700 GOSUB 160
710 BOARD(SQUARE)=PIECE
720 BOARD(TARGET_SQUARE)=CAPTURED_PIECE
730 GOSUB 160
1880 IF CAPTURED_PIECE <> 0 AND ((PIECES(CAPTURED_PIECE)&32)=32)<>SIDE THEN CONTINUE FOR
1890 IF TYPES(PIECE)=1 THEN CONTINUE FOR
1900 LOOP 
2000 NEXT DIRECTION
2010 NEXT SQUARE


